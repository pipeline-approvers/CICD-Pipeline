name: email
on:
  workflow_dispatch:
permissions:
  id-token: write
  contents: read
jobs:
  deploy:
    runs-on: nu-laptop # this is a self hosted windows server
    steps:
    - name: Checkout Code
      uses: actions/checkout@v3

    - name: Deploy
      run: echo "Deploying application..."
      
    - name: Send Email Notification
      if: always()
      uses: dawidd6/action-send-mail@v2
      with:
        server_address: email-smtp.us-east-1.amazonaws.com
        server_port: 587
        username: ${{ secrets.AWS_SES_SMTP_USERNAME }}
        password: ${{ secrets.AWS_SES_SMTP_PASSWORD }}
        subject: ${{ github.job }} job of ${{ github.repository }} has ${{ job.status }}
        body: ${{ github.job }} job in workflow ${{ github.workflow }} of ${{ github.repository }} has ${{ job.status }}
        to: madhukar.h1988@gmail.com
        from: 'madhukar.h1988@gmail.com'
